version: '3.8'

services:
  sftp:
    image: atmoz/sftp:latest
    container_name: sftp-server
    ports:
      - "2222:22"
    volumes:
      # ⭐ NUEVO: Montar clave pública para autenticación
      - ./ssh-keys/sftp_key.pub:/home/carlos/.ssh/keys/sftp_key.pub:ro
      # Directorio para archivos subidos
      - ./sftp-data:/home/carlos/uploads
    # ⭐ CAMBIO: Password vacío (::) indica autenticación solo SSH
    command: carlos::1001:1001

  # Navegador de archivos web (opcional)
  filebrowser:
    image: filebrowser/filebrowser
    container_name: sftp-filebrowser
    ports:
      - "8090:80"
    volumes:
      - ./sftp-data:/srv
    environment:
      - FB_NOAUTH=true